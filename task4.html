<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Post Loader</title>
<style>
  body{font-family:system-ui,Segoe UI,Roboto,Arial;background:#f8fafc;margin:28px}
  .wrap{max-width:720px;margin:0 auto;background:#fff;padding:18px;border-radius:10px;box-shadow:0 8px 30px rgba(2,6,23,0.06)}
  .btn{padding:8px 12px;border-radius:8px;border:0;background:#2563eb;color:#fff;cursor:pointer}
  .loading{color:#6b7280;margin-top:12px}
  ul{margin-top:12px}
</style>
</head>
<body>
  <div class="wrap">
    <h2>Posts</h2>
    <div style="display:flex;gap:8px">
      <button id="load" class="btn">Load Posts</button>
      <button id="retry" class="btn" style="background:#f59e0b">Retry Last</button>
    </div>
    <div id="status" class="loading"></div>
    <ul id="list"></ul>
  </div>

<script>
  const loadBtn = document.getElementById('load')
  const retryBtn = document.getElementById('retry')
  const status = document.getElementById('status')
  const list = document.getElementById('list')
  let lastPromiseFactory = null

  function delayedPosts(shouldReject=false){
    return new Promise((resolve,reject)=>{
      setTimeout(()=>{
        if(shouldReject) reject(new Error('Simulated failure'))
        else resolve(['Post 1','Post 2','Post 3','Post 4'])
      },2000)
    })
  }

  async function load(shouldReject=false){
    status.textContent = 'Loading posts...'
    list.innerHTML = ''
    lastPromiseFactory = ()=>delayedPosts(shouldReject)
    try{
      const posts = await delayedPosts(shouldReject)
      posts.forEach(p=>{
        const li = document.createElement('li'); li.textContent = p; list.appendChild(li)
      })
      status.textContent = ''
    }catch(e){
      status.textContent = 'Failed to load posts'
    }
  }

  loadBtn.addEventListener('click', ()=>load(false))
  retryBtn.addEventListener('click', ()=>{ if(lastPromiseFactory) lastPromiseFactory().then(posts=>{ list.innerHTML=''; posts.forEach(p=>{ const li=document.createElement('li'); li.textContent=p; list.appendChild(li) }) ; status.textContent='' }).catch(()=>{ status.textContent='Retry failed' }) })
</script>
</body>
</html>